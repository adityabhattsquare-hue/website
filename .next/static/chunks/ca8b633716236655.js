(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41628,e=>{"use strict";var a=e.i(43476),r=e.i(71645),s=e.i(46932),i=e.i(18566),t=e.i(59492),d=e.i(21128),n=e.i(6495),l=e.i(70397);function o(){let e=(0,i.useRouter)(),o=(0,t.useAppDispatch)(),{items:c,totalPrice:p,loading:m,isAuthenticated:u}=(0,t.useAppSelector)(e=>e.cart),{addresses:h,selectedAddress:x,loading:b}=(0,t.useAppSelector)(e=>e.address),{loading:y,error:g,currentOrder:j}=(0,t.useAppSelector)(e=>e.order),{isAuthenticated:f,user:N}=(0,t.useAppSelector)(e=>e.auth),[v,_]=(0,r.useState)("cart"),[C,k]=(0,r.useState)(!1),[w,S]=(0,r.useState)("card"),[A,q]=(0,r.useState)(""),[P,F]=(0,r.useState)({address_type:"home",phone:"",address_line1:"",landmark:"",city:"",postal_code:"",is_default:!1});(0,r.useEffect)(()=>{(async()=>{f?(await o((0,d.fetchCart)()),await o((0,n.fetchAddresses)())):o((0,d.loadLocalCart)())})()},[o,f]),(0,r.useEffect)(()=>{j&&e.push(`/order-confirmation/${j.order_id}`)},[j,e]);let O=async e=>{e.preventDefault();try{await o((0,n.createAddress)(P)).unwrap(),F({address_type:"home",phone:"",address_line1:"",landmark:"",city:"",postal_code:"",is_default:!1}),k(!1)}catch(e){console.error("Failed to add address:",e)}},I=async()=>{if(!x)return void alert("Please select a shipping address");if(0===c.length)return void alert("Your cart is empty");let e={payment_method:w,shipping_address_id:x.address_id,billing_address_id:x.address_id,customer_notes:A};try{await o((0,l.createOrder)(e)).unwrap()}catch(e){console.error("Failed to create order:",e)}},T=c.map(e=>({id:e.product_id||e.id,cart_item_id:e.cart_item_id||`local_${e.product_id||e.id}`,name:e.product_name||e.name,price:e.price,quantity:e.quantity,image:e.image_url||e.image})),$=.18*p,D=p>=5e3?0:100,B=p+$+D;return f?(0,a.jsx)("div",{className:"min-h-screen bg-background py-12 px-4",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"Checkout"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"md:col-span-2 space-y-6",children:["cart"===v&&(0,a.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-accent rounded-2xl p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Order Summary"}),0===T.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-foreground/70 mb-4",children:"Your cart is empty"}),(0,a.jsx)("a",{href:"/shop",className:"text-primary hover:underline",children:"Continue Shopping"})]}):(0,a.jsx)("div",{className:"space-y-4",children:T.map(e=>(0,a.jsxs)("div",{className:"flex gap-4 pb-4 border-b border-border last:border-b-0",children:[(0,a.jsx)("img",{src:e.image||"/placeholder.svg",alt:e.name,className:"w-24 h-24 rounded-lg object-cover"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:e.name}),(0,a.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("button",{onClick:()=>{f?o((0,d.updateQuantity)({itemId:e.cart_item_id,quantity:Math.max(1,e.quantity-1)})):o((0,d.updateQuantity)({id:e.id,quantity:Math.max(1,e.quantity-1)}))},className:"px-2 py-1 bg-background rounded hover:bg-primary/10",children:"âˆ’"}),(0,a.jsx)("span",{className:"w-6 text-center",children:e.quantity}),(0,a.jsx)("button",{onClick:()=>{f?o((0,d.updateQuantity)({itemId:e.cart_item_id,quantity:e.quantity+1})):o((0,d.updateQuantity)({id:e.id,quantity:e.quantity+1}))},className:"px-2 py-1 bg-background rounded hover:bg-primary/10",children:"+"})]}),(0,a.jsxs)("span",{className:"text-primary font-semibold",children:["â‚¹",(e.price*e.quantity).toFixed(2)]}),(0,a.jsx)("button",{onClick:()=>{f?o((0,d.clearCartAPI)(e.cart_item_id)):o((0,d.removeFromCart)(e.id))},className:"text-red-500 hover:opacity-70",children:"Remove"})]})]})]},e.cart_item_id))}),T.length>0&&(0,a.jsx)("button",{onClick:()=>_("shipping"),className:"w-full mt-6 py-3 bg-primary text-white rounded-lg font-semibold hover:opacity-90 transition",children:"Continue to Shipping"})]}),"shipping"===v&&(0,a.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-accent rounded-2xl p-6 space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Shipping Information"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Select Shipping Address"}),b?(0,a.jsx)("div",{className:"space-y-4",children:[1,2].map(e=>(0,a.jsxs)("div",{className:"bg-background rounded-lg p-4 animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-300 rounded mb-2 w-3/4"}),(0,a.jsx)("div",{className:"h-4 bg-gray-300 rounded w-1/2"})]},e))}):0===h.length?(0,a.jsx)("p",{className:"text-foreground/70 mb-4",children:"No addresses saved"}):(0,a.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,a.jsx)("div",{className:`bg-background rounded-lg p-4 border-2 cursor-pointer transition ${x?.address_id===e.address_id?"border-primary bg-primary/5":"border-transparent hover:border-primary/50"}`,onClick:()=>o((0,n.setSelectedAddress)(e)),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold capitalize",children:e.address_type}),(0,a.jsx)("p",{className:"text-foreground/80",children:e.address_line1}),(0,a.jsxs)("p",{className:"text-foreground/80",children:[e.landmark&&`${e.landmark}, `,e.city," - ",e.postal_code]}),(0,a.jsxs)("p",{className:"text-foreground/80",children:["Phone: ",e.phone]})]}),e.is_default&&(0,a.jsx)("span",{className:"bg-green-500 text-white px-2 py-1 rounded text-xs",children:"Default"})]})},e.address_id))}),(0,a.jsx)("button",{onClick:()=>k(!0),className:"w-full mt-4 py-3 border-2 border-dashed border-primary text-primary rounded-lg font-semibold hover:bg-primary/10 transition",children:"+ Add New Address"}),C&&(0,a.jsxs)(s.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-6 p-4 bg-background rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold mb-4",children:"Add New Address"}),(0,a.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("select",{value:P.address_type,onChange:e=>F({...P,address_type:e.target.value}),className:"px-4 py-2 bg-accent rounded-lg border border-border focus:outline-none focus:ring-2 focus:ring-primary",children:[(0,a.jsx)("option",{value:"home",children:"Home"}),(0,a.jsx)("option",{value:"work",children:"Work"}),(0,a.jsx)("option",{value:"other",children:"Other"})]}),(0,a.jsx)("input",{type:"tel",placeholder:"Phone Number",value:P.phone,onChange:e=>F({...P,phone:e.target.value}),className:"px-4 py-2 bg-accent rounded-lg border border-border focus:outline-none focus:ring-2 focus:ring-primary",required:!0})]}),(0,a.jsx)("input",{type:"text",placeholder:"Address Line 1",value:P.address_line1,onChange:e=>F({...P,address_line1:e.target.value}),className:"w-full px-4 py-2 bg-accent rounded-lg border border-border focus:outline-none focus:ring-2 focus:ring-primary",required:!0}),(0,a.jsx)("input",{type:"text",placeholder:"Landmark (Optional)",value:P.landmark,onChange:e=>F({...P,landmark:e.target.value}),className:"w-full px-4 py-2 bg-accent rounded-lg border border-border focus:outline-none focus:ring-2 focus:ring-primary"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"City",value:P.city,onChange:e=>F({...P,city:e.target.value}),className:"px-4 py-2 bg-accent rounded-lg border border-border focus:outline-none focus:ring-2 focus:ring-primary",required:!0}),(0,a.jsx)("input",{type:"text",placeholder:"Postal Code",value:P.postal_code,onChange:e=>F({...P,postal_code:e.target.value}),className:"px-4 py-2 bg-accent rounded-lg border border-border focus:outline-none focus:ring-2 focus:ring-primary",required:!0})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:P.is_default,onChange:e=>F({...P,is_default:e.target.checked}),className:"w-4 h-4 accent-primary"}),(0,a.jsx)("span",{children:"Set as default address"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 py-2 bg-primary text-white rounded-lg font-semibold hover:opacity-90 transition",children:"Save Address"}),(0,a.jsx)("button",{type:"button",onClick:()=>k(!1),className:"flex-1 py-2 border border-primary text-primary rounded-lg font-semibold hover:bg-primary/10 transition",children:"Cancel"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>_("cart"),className:"flex-1 py-3 border border-primary text-primary rounded-lg font-semibold hover:bg-primary/10 transition",children:"Back to Cart"}),(0,a.jsx)("button",{onClick:()=>_("payment"),disabled:!x,className:"flex-1 py-3 bg-primary text-white rounded-lg font-semibold hover:opacity-90 transition disabled:opacity-50",children:"Continue to Payment"})]})]}),"payment"===v&&(0,a.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-accent rounded-2xl p-6 space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Payment Information"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Select Payment Method"}),(0,a.jsx)("div",{className:"space-y-3",children:[{id:"card",label:"Credit/Debit Card",icon:"ðŸ’³"},{id:"paypal",label:"PayPal",icon:"ðŸ”µ"},{id:"upi",label:"UPI",icon:"ðŸ“±"},{id:"cod",label:"Cash on Delivery",icon:"ðŸ’°"}].map(e=>(0,a.jsxs)("label",{className:`flex items-center gap-4 p-4 bg-background rounded-lg border-2 cursor-pointer transition ${w===e.id?"border-primary bg-primary/5":"border-transparent hover:border-primary/50"}`,children:[(0,a.jsx)("input",{type:"radio",name:"payment",value:e.id,checked:w===e.id,onChange:e=>S(e.target.value),className:"w-4 h-4 accent-primary"}),(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsx)("span",{className:"font-medium",children:e.label})]},e.id))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Additional Notes (Optional)"}),(0,a.jsx)("textarea",{value:A,onChange:e=>q(e.target.value),placeholder:"Any special instructions for your order...",className:"w-full px-4 py-3 bg-background rounded-lg border border-border focus:outline-none focus:ring-2 focus:ring-primary resize-none",rows:"3"})]}),g&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500 text-red-500 rounded-lg p-4",children:g}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>_("shipping"),className:"flex-1 py-3 border border-primary text-primary rounded-lg font-semibold hover:bg-primary/10 transition",children:"Back to Shipping"}),(0,a.jsx)("button",{onClick:I,disabled:y||0===c.length,className:"flex-1 py-3 bg-primary text-white rounded-lg font-semibold hover:opacity-90 transition disabled:opacity-50",children:y?"Placing Order...":"Place Order"})]})]})]}),(0,a.jsxs)(s.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-accent rounded-2xl p-6 h-fit sticky top-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Order Summary"}),(0,a.jsx)("div",{className:"space-y-3 mb-4",children:T.map(e=>(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"flex-1 truncate",children:[e.name," Ã— ",e.quantity]}),(0,a.jsxs)("span",{className:"ml-2 font-medium",children:["â‚¹",(e.price*e.quantity).toFixed(2)]})]},e.cart_item_id))}),(0,a.jsxs)("div",{className:"space-y-2 pb-4 border-b border-border",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Subtotal"}),(0,a.jsxs)("span",{children:["â‚¹",p.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Shipping"}),(0,a.jsx)("span",{children:0===D?"Free":`â‚¹${D.toFixed(2)}`})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Tax (18%)"}),(0,a.jsxs)("span",{children:["â‚¹",$.toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-lg font-bold pt-4 text-primary",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{children:["â‚¹",B.toFixed(2)]})]})]})]})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Please Login to Checkout"}),(0,a.jsx)("a",{href:"/login",className:"text-primary hover:underline",children:"Sign in to your account"})]})})}e.s(["default",()=>o])}]);